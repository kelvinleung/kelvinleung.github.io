{"pageProps":{"meta":{"title":"使用 Next.js 与 MDX 搭建一个静态博客（二）","date":"JUNE 9, 2022","desc":"在上一篇介绍博客搭建的文章里，小结了 Next 的基本项目结构、全局布局，以及怎样读取 MDX 的头数据等。这次继续介绍如何解析 MDX 的内容到博客文章页面，以及代码块如何高亮。","type":"horse-sense"},"code":"var Component=(()=>{var a=Object.create;var d=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var u=(t,c)=>()=>(c||t((c={exports:{}}).exports,c),c.exports),f=(t,c)=>{for(var o in c)d(t,o,{get:c[o],enumerable:!0})},i=(t,c,o,n)=>{if(c&&typeof c==\"object\"||typeof c==\"function\")for(let r of p(c))!g.call(t,r)&&r!==o&&d(t,r,{get:()=>c[r],enumerable:!(n=h(c,r))||n.enumerable});return t};var x=(t,c,o)=>(o=t!=null?a(m(t)):{},i(c||!t||!t.__esModule?d(o,\"default\",{value:t,enumerable:!0}):o,t)),j=t=>i(d({},\"__esModule\",{value:!0}),t);var l=u((M,s)=>{s.exports=_jsx_runtime});var D={};f(D,{default:()=>b,frontmatter:()=>P});var e=x(l()),P={title:\"\\u4F7F\\u7528 Next.js \\u4E0E MDX \\u642D\\u5EFA\\u4E00\\u4E2A\\u9759\\u6001\\u535A\\u5BA2\\uFF08\\u4E8C\\uFF09\",date:\"JUNE 9, 2022\",desc:\"\\u5728\\u4E0A\\u4E00\\u7BC7\\u4ECB\\u7ECD\\u535A\\u5BA2\\u642D\\u5EFA\\u7684\\u6587\\u7AE0\\u91CC\\uFF0C\\u5C0F\\u7ED3\\u4E86 Next \\u7684\\u57FA\\u672C\\u9879\\u76EE\\u7ED3\\u6784\\u3001\\u5168\\u5C40\\u5E03\\u5C40\\uFF0C\\u4EE5\\u53CA\\u600E\\u6837\\u8BFB\\u53D6 MDX \\u7684\\u5934\\u6570\\u636E\\u7B49\\u3002\\u8FD9\\u6B21\\u7EE7\\u7EED\\u4ECB\\u7ECD\\u5982\\u4F55\\u89E3\\u6790 MDX \\u7684\\u5185\\u5BB9\\u5230\\u535A\\u5BA2\\u6587\\u7AE0\\u9875\\u9762\\uFF0C\\u4EE5\\u53CA\\u4EE3\\u7801\\u5757\\u5982\\u4F55\\u9AD8\\u4EAE\\u3002\",type:\"horse-sense\"};function y(t={}){let{wrapper:c}=t.components||{};return c?(0,e.jsx)(c,Object.assign({},t,{children:(0,e.jsx)(o,{})})):o();function o(){let n=Object.assign({p:\"p\",a:\"a\",pre:\"pre\",code:\"code\",h2:\"h2\",h3:\"h3\",ol:\"ol\",li:\"li\",img:\"img\",h4:\"h4\"},t.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.p,{children:[\"\\u5728\\u4E0A\\u4E00\\u7BC7\\u4ECB\\u7ECD\",(0,e.jsx)(n.a,{href:\"how-to-build-a-static-blog-with-nextjs-and-mdx-i\",children:\"\\u535A\\u5BA2\\u642D\\u5EFA\\u7684\\u6587\\u7AE0\"}),\"\\u91CC\\uFF0C\\u5C0F\\u7ED3\\u4E86 Next \\u7684\\u57FA\\u672C\\u9879\\u76EE\\u7ED3\\u6784\\u3001\\u5168\\u5C40\\u5E03\\u5C40\\uFF0C\\u4EE5\\u53CA\\u600E\\u6837\\u8BFB\\u53D6 MDX \\u7684\\u5934\\u6570\\u636E\\u7B49\\u3002\\u8FD9\\u6B21\\u7EE7\\u7EED\\u4ECB\\u7ECD\\u5982\\u4F55\\u89E3\\u6790 MDX \\u7684\\u5185\\u5BB9\\u5230\\u535A\\u5BA2\\u6587\\u7AE0\\u9875\\u9762\\uFF0C\\u4EE5\\u53CA\\u4EE3\\u7801\\u5757\\u5982\\u4F55\\u9AD8\\u4EAE\\u3002\\u4EE5\\u4E0B\\u9762\\u7684\\u76EE\\u5F55\\u7ED3\\u6784\\u4E3A\\u8D77\\u70B9\\uFF1A\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-bash\",children:`components/\n  |--- Layout.jsx\n  |--- NavBar.jsx\n  |--- Footer.jsx\nlib/\n  |--- posts.js\npages/  # \\u76EE\\u5F55\\u4E2D\\u7684 js \\u6587\\u4EF6\\u5C06\\u88AB\\u89E3\\u6790\\u751F\\u6210\\u9875\\u9762\n  |--- _app.js  # \\u5168\\u5C40\\u5E03\\u5C40\\u3001\\u6837\\u5F0F\\u5728\\u8FD9\\u91CC\\u8BBE\\u7F6E\n  |--- index.js  # \\u901A\\u8FC7 http://yoursite/ \\u6765\\u8BBF\\u95EE\nposts/  # \\u6587\\u7AE0\\u76EE\\u5F55\\uFF0C\\u653E mdx \\u6587\\u4EF6\n  |--- first-post.mdx\npublic/  # \\u653E\\u56FE\\u7247\\u3001\\u56FE\\u6807\\u7B49\\u9759\\u6001\\u8D44\\u6E90\nstyles/  # \\u653E css \\u6587\\u4EF6\nnext.config.js  # Next.js \\u7684\\u914D\\u7F6E\\u6587\\u4EF6\n`})}),`\n`,(0,e.jsx)(n.h2,{children:\"\\u535A\\u5BA2\\u6587\\u7AE0\\u9875\\u9762\"}),`\n`,(0,e.jsx)(n.h3,{children:\"\\u7B2C\\u4E00\\u6B65\\uFF1A\\u52A8\\u6001\\u8DEF\\u7531\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u5728 Next \\u4E2D\\uFF0C\\u9664\\u4E86\",(0,e.jsx)(n.code,{children:\"pages/index.js\"}),\"\\u8FD9\\u79CD\\u751F\\u6210\\u201C\\u56FA\\u5B9A\\u201D\\u94FE\\u63A5\\u7684\\u9875\\u9762\\uFF0C\\u8FD8\\u53EF\\u4EE5\\u751F\\u6210\\u201C\\u52A8\\u6001\\u201D\\u94FE\\u63A5\\u7684\\u9875\\u9762\\u3002\\u6211\\u4EEC\\u5E0C\\u671B\\u4EE5\",(0,e.jsx)(n.code,{children:\"http://localhost:3000/post/:id\"}),\"\\u7684\\u94FE\\u63A5\\u6765\\u8BBF\\u95EE\\u76F8\\u5E94\\u7684\\u6587\\u7AE0\\uFF0C\\u8FD9\\u91CC\\u7684\",(0,e.jsx)(n.code,{children:\"id\"}),\"\\u5C31\\u662F\\u201C\\u52A8\\u6001\\u201D\\u7684\\u90E8\\u5206\\uFF0C\\u5B83\\u6839\\u636E\\u6587\\u7AE0\\u7684 id\\uFF08\\u6587\\u4EF6\\u540D\\uFF09\\u52A8\\u6001\\u751F\\u6210\\u3002\\u6211\\u4EEC\\u7684\\u6587\\u7AE0\\u4EE5 MDX \\u6587\\u4EF6\\u7684\\u5F62\\u5F0F\\u653E\\u5728\",(0,e.jsx)(n.code,{children:\"posts/\"}),\"\\u76EE\\u5F55\\u4E2D\\uFF0C\\u53EF\\u4EE5\\u5229\\u7528 Next \\u7684\",(0,e.jsx)(n.a,{href:\"https://nextjs.org/docs/routing/dynamic-routes\",children:\"\\u52A8\\u6001\\u8DEF\\u7531\\uFF08Dynamic Routes\\uFF09\"}),\"\\u673A\\u5236\\u6765\\u5B9E\\u73B0\\u3002\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u6211\\u4EEC\\u5E0C\\u671B\\u6700\\u7EC8\\u7684\\u8DEF\\u7531\\u7528\\u6587\\u7AE0\\u7684\\u6807\\u9898\\u6765\\u7EC4\\u6210\\uFF0C\\u5982\",(0,e.jsx)(n.code,{children:\"/post/hello-world\"}),\"\\u3001\",(0,e.jsx)(n.code,{children:\"/post/my-post\"}),\"\\u7B49\\u3002\\u4E3A\\u6B64\\u6211\\u4EEC\\u5728\",(0,e.jsx)(n.code,{children:\"pages/\"}),\"\\u76EE\\u5F55\\u4E0B\\u65B0\\u5EFA\",(0,e.jsx)(n.code,{children:\"pages/post/[id].js\"}),\"\\u6587\\u4EF6\\u3002\\u5176\\u4E2D\\uFF0C\\u6587\\u4EF6\\u540D\\u4E2D\\u7684\",(0,e.jsx)(n.code,{children:\"[id]\"}),\"\\u8868\\u793A\\u6587\\u7AE0\\u5BF9\\u5E94 MDX \\u6587\\u4EF6\\u7684\\u6587\\u4EF6\\u540D\\uFF0C\\u5C06\\u7528\\u4E8E\\u751F\\u6210\\u52A8\\u6001\\u8DEF\\u7531\\u3002\\u5173\\u4E8E\\u52A8\\u6001\\u8DEF\\u7531\\u7684\\u8BE6\\u7EC6\\u7528\\u6CD5\\uFF0C\\u53EF\\u4EE5\\u770B Next \\u7684\",(0,e.jsx)(n.a,{href:\"https://nextjs.org/docs/routing/dynamic-routes\",children:\"\\u5B98\\u65B9\\u6587\\u6863\"}),\"\\uFF0C\\u8FD9\\u91CC\\u4E0D\\u518D\\u8D58\\u8FF0\\u3002\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u6211\\u4EEC\\u7684\\u9875\\u9762\\u662F\\u9759\\u6001\\u751F\\u6210\\u7684\\uFF0C\\u5728\",(0,e.jsx)(n.code,{children:\"[id].js\"}),\"\\u6587\\u4EF6\\u4E2D\\uFF0C\\u6211\\u4EEC\\u4F7F\\u7528\",(0,e.jsx)(n.code,{children:\"getStaticPaths()\"}),\"\\u65B9\\u6CD5\\uFF0C\\u6765\\u751F\\u6210\\u76F8\\u5E94\\u7684\\u52A8\\u6001\\u8DEF\\u7531\\u3002\\u8BE5\\u65B9\\u6CD5\\u9700\\u8981\\u8FD4\\u56DE\\u4E00\\u4E2A\",(0,e.jsx)(n.code,{children:\"paths\"}),\"\\u6570\\u7EC4\\uFF0C\\u679A\\u4E3E\\u6240\\u6709\\u53EF\\u80FD\\u7684\\u52A8\\u6001\\u8DEF\\u7531\\uFF0C\\u5BF9\\u4E8E\\u6211\\u4EEC\\u7684\\u535A\\u5BA2\\u9879\\u76EE\\u6765\\u8BF4\\uFF0C\\u5C31\\u662F\\u8981\\u8FD4\\u56DE\\u6240\\u6709\\u6587\\u7AE0\\u7684\",(0,e.jsx)(n.code,{children:\"id\"}),\"\\u3002\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u7531\\u4E8E\\u6211\\u4EEC\\u53EA\\u9700\\u8981\\u8FD4\\u56DE\\u6587\\u7AE0\\u7684 id\\uFF0C\\u76F4\\u63A5\\u8C03\\u7528\\u4E0A\\u56DE\\u63D0\\u5230\\u7684\",(0,e.jsx)(n.code,{children:\"getAllPosts()\"}),\"\\u65B9\\u6CD5\\u5373\\u53EF\\uFF1A\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-js\",metastring:\"title=pages/post/[id].js\",children:`import { getAllPosts } from \"lib/posts\";\n\nexport async function getStaticPaths() {\n  const posts = getAllPosts();\n  return {\n    paths: posts.map((post) => ({\n      params: { id: post.id },\n    })),\n    fallback: false,\n  };\n}\n`})}),`\n`,(0,e.jsx)(n.h3,{children:\"\\u7B2C\\u4E8C\\u6B65\\uFF1A\\u8BFB\\u53D6\\u9875\\u9762\\u6570\\u636E\"}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"getStaticPaths()\"}),\"\\u65B9\\u6CD5\\u8FD8\\u9700\\u8981\\u642D\\u914D\",(0,e.jsx)(n.code,{children:\"getStaticProps()\"}),\"\\u65B9\\u6CD5\\u4E00\\u8D77\\u4F7F\\u7528\\uFF0C\\u540E\\u8005\\u5C06\\u8FD4\\u56DE\\u4E00\\u4E2A\",(0,e.jsx)(n.code,{children:\"props\"}),\"\\u5BF9\\u8C61\\uFF0C\\u5728\\u751F\\u6210\\u9759\\u6001\\u9875\\u9762\\u65F6\\uFF0C\\u4F5C\\u4E3A\\u6587\\u7AE0\\u9875\\u9762\\u7EC4\\u4EF6\\u7684\\u53C2\\u6570\\u4F7F\\u7528\\u3002\",(0,e.jsx)(n.code,{children:\"getStaticProps(context)\"}),\"\\u65B9\\u6CD5\\u63A5\\u53D7\\u4E00\\u4E2A\",(0,e.jsx)(n.code,{children:\"context\"}),\"\\u5BF9\\u8C61\\u4F5C\\u4E3A\\u53C2\\u6570\\uFF0C\\u5176\\u4E2D\",(0,e.jsx)(n.code,{children:\"context.params\"}),\"\\u5C5E\\u6027\\u5305\\u542B\\u4E86\\u8DEF\\u7531\\u4FE1\\u606F\\uFF0C\\u5373\",(0,e.jsx)(n.code,{children:\"getStaticPaths()\"}),\"\\u65B9\\u6CD5\\u8FD4\\u56DE\\u7684\",(0,e.jsx)(n.code,{children:\"paths\"}),\"\\u6570\\u7EC4\\u4E2D\\u6BCF\\u4E00\\u4E2A\\u5BF9\\u8C61\\u4E2D\\u7684\",(0,e.jsx)(n.code,{children:\"params\"}),\"\\u5C5E\\u6027\\u3002\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u53EF\\u80FD\\u6709\\u70B9\\u7ED5\\uFF0C\\u4E3E\\u4F8B\\u5C31\\u662F\\u5BF9\\u4E8E\",(0,e.jsx)(n.code,{children:\"[id].js\"}),\"\\u9875\\u9762\\u6765\\u8BF4\\uFF0C\",(0,e.jsx)(n.code,{children:\"context.params\"}),\"\\u5373\",(0,e.jsx)(n.code,{children:\"{id: ...}\"}),\"\\u3002\\u6211\\u4EEC\\u53EF\\u4EE5\\u901A\\u8FC7\",(0,e.jsx)(n.code,{children:\"id\"}),\"\\u62FF\\u5230\\u6587\\u4EF6\\u540D\\uFF0C\\u518D\\u53BB\\u8BFB\\u53D6\\u5BF9\\u5E94\\u7684 MDX \\u6587\\u4EF6\\uFF0C\\u89E3\\u6790\\u51FA\\u6587\\u7AE0\\u7684\\u5177\\u4F53\\u5185\\u5BB9\\u3002\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u6211\\u4EEC\\u901A\\u8FC7\",(0,e.jsx)(n.code,{children:\"mdx-bundler\"}),\"\\u7684\",(0,e.jsx)(n.code,{children:\"bundleMDX()\"}),\"\\u65B9\\u6CD5\\u6765\\u89E3\\u6790\\u8BFB\\u53D6\\u5230\\u7684 MDX \\u6587\\u4EF6\\u6570\\u636E\\uFF0C\\u8BE5\\u65B9\\u6CD5\\u4F1A\\u8FD4\\u56DE\\u89E3\\u6790\\u597D\\u7684\\u6B63\\u6587\\u5185\\u5BB9\\uFF08\",(0,e.jsx)(n.code,{children:\"code\"}),\"\\uFF09\\u548C\",(0,e.jsx)(n.code,{children:\"frontmatter\"}),\"\\u5934\\u90E8\\u6570\\u636E\\uFF0C\\u6211\\u4EEC\\u9700\\u8981\\u5C06\\u8FD9\\u4E9B\\u6570\\u636E\\u4EE5\",(0,e.jsx)(n.code,{children:\"props\"}),\"\\u5BF9\\u8C61\\u7684\\u5F62\\u5F0F\\u8FD4\\u56DE\\uFF0C\\u5982\\u4E0B\\uFF1A\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-js\",metastring:\"title=pages/post/[id].js\",children:`import fs from \"fs\";\nimport path from \"path\";\nimport { bundleMDX } from \"mdx-bundler\";\nimport { postsDirectory } from \"lib/posts\";\n\nexport async function getStaticProps({ params }) {\n  const filePath = path.join(postsDirectory, \\`\\${params.id}.mdx\\`);\n  const fileContent = fs.readFileSync(filePath, \"utf-8\");\n\n  const { code, frontmatter } = await bundleMDX({\n    source: fileContent,\n    // \\u63D2\\u4EF6\\uFF0C\\u540E\\u9762\\u4F1A\\u6709\\u8BB2\\u5230\n  });\n\n  return { props: { meta: frontmatter, code } };\n}\n`})}),`\n`,(0,e.jsx)(n.h3,{children:\"\\u7B2C\\u4E09\\u6B65\\uFF1A\\u9875\\u9762\\u7EC4\\u4EF6\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u6709\\u4E86\\u89E3\\u6790\\u597D\\u7684\\u6587\\u7AE0\\u6570\\u636E\\u540E\\uFF0C\\u6211\\u4EEC\\u5C31\\u53EF\\u4EE5\\u6765\\u5199\\u9875\\u9762\\u7EC4\\u4EF6\\u4E86\\u3002\\u524D\\u9762\\u63D0\\u5230\\u7684\\u6B63\\u6587\\u6570\\u636E\",(0,e.jsx)(n.code,{children:\"code\"}),\"\\uFF0C\\u5E76\\u4E0D\\u80FD\\u76F4\\u63A5\\u4F7F\\u7528\\uFF0C\\u9700\\u8981\\u7528\",(0,e.jsx)(n.code,{children:\"mdx-bundler\"}),\"\\u7684\",(0,e.jsx)(n.code,{children:\"getMDXComponent()\"}),\"\\u65B9\\u6CD5\\u518D\\u89E3\\u6790\\u4E00\\u904D\\uFF0C\\u5F97\\u5230\\u4E00\\u4E2A React \\u7EC4\\u4EF6\\uFF08\",(0,e.jsx)(n.code,{children:\"<Content />\"}),\"\\uFF09\\u3002\\u4F60\\u53EF\\u4EE5\\u76F4\\u63A5\\u4F7F\\u7528\\u8BE5\\u7EC4\\u4EF6\\uFF0C\\u6216\\u8005\\u81EA\\u5DF1\\u5199\\u4E00\\u4E2A\",(0,e.jsx)(n.code,{children:\"<PostLayout />\"}),\"\\u5E03\\u5C40\\u7684\\u7EC4\\u4EF6\\u628A\\u6B63\\u6587\\u5957\\u8FDB\\u53BB\\uFF1A\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-js\",metastring:\"title=pages/post/[id].js\",children:`import { getMDXComponent } from \"mdx-bundler/client\";\nimport PostLayout from \"components/PostLayout\";\n\nexport default function Post({ meta, code }) {\n  const Content = getMDXComponent(code);\n  return (\n    <PostLayout meta={meta}>\n      <Content />\n    </PostLayout>\n  );\n}\n`})}),`\n`,(0,e.jsx)(n.h3,{children:\"\\u5C0F\\u7ED3\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u5230\\u6B64\\u4E3A\\u6B62\\uFF0C\\u6211\\u4EEC\\u7684\\u6587\\u7AE0\\u9875\\u9762\\u5C31\\u5199\\u597D\\u4E86\\u3002\\u6211\\u4EEC\\u6765\\u5C0F\\u7ED3\\u4E00\\u4E0B\\u6574\\u4E2A\\u6D41\\u7A0B\\u3002\"}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsxs)(n.li,{children:[\"\\u5F53 Next \\u751F\\u6210\\u52A8\\u6001\\u8DEF\\u7531\\u9875\\u9762\\u65F6\\uFF0C\\u4F1A\\u8C03\\u7528\",(0,e.jsx)(n.code,{children:\"getStaticPaths()\"}),\"\\u548C\",(0,e.jsx)(n.code,{children:\"getStaticProps()\"}),\"\\u4E24\\u4E2A\\u65B9\\u6CD5\\u3002\\u524D\\u8005\\u7528\\u4E8E\\u751F\\u6210\\u8DEF\\u7531\\uFF0C\\u540E\\u8005\\u7ED9\\u7EC4\\u4EF6\\u63D0\\u4F9B\",(0,e.jsx)(n.code,{children:\"props\"}),\"\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[\"\\u5F53 Next \\u8C03\\u7528\",(0,e.jsx)(n.code,{children:\"getStaticPaths()\"}),\"\\u65B9\\u6CD5\\u65F6\\uFF0C\\u6211\\u4EEC\\u5229\\u7528\",(0,e.jsx)(n.code,{children:\"getAllPosts()\"}),\"\\u65B9\\u6CD5\\uFF0C\\u8BFB\\u53D6\\u6587\\u7AE0\\u76EE\\u5F55\\u4E2D\\u6240\\u6709\\u7684 MDX \\u6587\\u4EF6\\u6570\\u636E\\uFF0C\\u751F\\u6210\",(0,e.jsx)(n.code,{children:\"paths\"}),\"\\u6570\\u7EC4\\u3002\\u6570\\u7EC4\\u4E2D\\u7684\\u6BCF\\u4E00\\u9879\\u5BF9\\u5E94\\u4E00\\u4E2A\\u6587\\u7AE0\\u9875\\u9762\\u7684\\u52A8\\u6001\\u8DEF\\u7531\\uFF0C\\u5373\",(0,e.jsx)(n.code,{children:\"id\"}),\"\\uFF0C\\u5E76\\u901A\\u8FC7\",(0,e.jsx)(n.code,{children:\"context.params\"}),\"\\u63D0\\u4F9B\\u7ED9\",(0,e.jsx)(n.code,{children:\"getStaticProps()\"}),\"\\u65B9\\u6CD5\\u4F7F\\u7528\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"getStaticProps()\"}),\"\\u65B9\\u6CD5\\uFF0C\\u901A\\u8FC7\\u8C03\\u7528\",(0,e.jsx)(n.code,{children:\"bundleMDX()\"}),\"\\u65B9\\u6CD5\\uFF0C\\u627E\\u5230\\u76F8\\u5E94\\u7684 MDX \\u6587\\u4EF6\\u8FDB\\u884C\\u89E3\\u6790\\uFF0C\\u8FD4\\u56DE\",(0,e.jsx)(n.code,{children:\"code\"}),\"\\u4E0E\",(0,e.jsx)(n.code,{children:\"meta\"}),\"\\u7EC4\\u6210\\u7684\",(0,e.jsx)(n.code,{children:\"props\"}),\"\\u7ED9\\u5230\",(0,e.jsx)(n.code,{children:\"<Post/>\"}),\"\\u7EC4\\u4EF6\\u4F7F\\u7528\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"<Post/>\"}),\"\\u7EC4\\u4EF6\\uFF0C\\u901A\\u8FC7\\u8C03\\u7528\",(0,e.jsx)(n.code,{children:\"getMDXComponent()\"}),\"\\u65B9\\u6CD5\\uFF0C\\u5C06\",(0,e.jsx)(n.code,{children:\"props.code\"}),\"\\u8F6C\\u5316\\u6210\",(0,e.jsx)(n.code,{children:\"<Content/>\"}),\"\\u7EC4\\u4EF6\\uFF0C\\u663E\\u793A\\u6587\\u7AE0\\u6B63\\u6587\\u5185\\u5BB9\\u3002\"]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"\\u5927\\u81F4\\u6D41\\u7A0B\\u5982\\u4E0B\\u56FE\\u6240\\u793A\\uFF1A\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/images/how-to-build-a-static-blog-with-nextjs-and-mdx-ii/flow.png\",alt:\"\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u6B64\\u65F6\",(0,e.jsx)(n.code,{children:\"[id].js\"}),\"\\u6587\\u4EF6\\u7684\\u5B8C\\u6574\\u4EE3\\u7801\\u5982\\u4E0B\\uFF1A\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-js\",metastring:\"title=pages/post/[id].js\",children:`import fs from \"fs\";\nimport path from \"path\";\nimport { bundleMDX } from \"mdx-bundler\";\nimport { getMDXComponent } from \"mdx-bundler/client\";\nimport PostLayout from \"components/PostLayout\";\nimport { postsDirectory, getAllPosts } from \"lib/posts\";\n\nexport async function getStaticPaths() {\n  const posts = getAllPosts();\n  return {\n    paths: posts.map((post) => ({\n      params: { id: post.id },\n    })),\n    fallback: false,\n  };\n}\n\nexport async function getStaticProps({ params }) {\n  const filePath = path.join(postsDirectory, \\`\\${params.id}.mdx\\`);\n  const fileContent = fs.readFileSync(filePath, \"utf-8\");\n\n  const { code, frontmatter } = await bundleMDX({\n    source: fileContent,\n    // \\u63D2\\u4EF6\\uFF0C\\u540E\\u9762\\u4F1A\\u6709\\u8BB2\\u5230\n  });\n\n  return { props: { meta: frontmatter, code } };\n}\n\nexport default function Post({ meta, code }) {\n  const Content = getMDXComponent(code);\n  return (\n    <PostLayout meta={meta}>\n      <Content />\n    </PostLayout>\n  );\n}\n`})}),`\n`,(0,e.jsx)(n.h2,{children:\"\\u4EE3\\u7801\\u9AD8\\u4EAE\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u4F5C\\u4E3A\\u4E00\\u4E2A\\u5F00\\u53D1\\u8005\\u7684\\u535A\\u5BA2\\uFF0C\\u6587\\u7AE0\\u4E2D\\u5FC5\\u5B9A\\u5C11\\u4E0D\\u4E86\\u4EE3\\u7801\\u5757\\uFF0C\\u800C\\u9ED8\\u8BA4\\u60C5\\u51B5\\u4E0B\\u4EE3\\u7801\\u5757\\u7684\\u6837\\u5F0F\\u975E\\u5E38\\u5F71\\u54CD\\u9605\\u8BFB\\uFF0C\\u5982\\u4E0B\\u56FE\\uFF1A\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/images/how-to-build-a-static-blog-with-nextjs-and-mdx-ii/plain-code.png\",alt:\"\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u56E0\\u6B64\\u6211\\u4EEC\\u9700\\u8981\\u628A\\u4EE3\\u7801\\u5757\\u9AD8\\u4EAE\\u5316\\u5904\\u7406\\u3002\\u53EF\\u4EE5\\u5B9E\\u73B0\\u4EE3\\u7801\\u9AD8\\u4EAE\\u7684\\u8F6E\\u5B50\\u6709\\u5F88\\u591A\\uFF0C\\u6BD4\\u8F83\\u5E38\\u7528\\u7684\\u662F \",(0,e.jsx)(n.a,{href:\"https://prismjs.com/\",children:\"Prism.js\"}),\" \\u548C \",(0,e.jsx)(n.a,{href:\"https://highlightjs.org/\",children:\"highlight.js\"}),\" \\u8FD9\\u4E24\\u4E2A\\u3002\\u6211\\u6700\\u7EC8\\u9009\\u62E9\\u7684\\u662F Prism\\uFF0C\\u7528\\u5230 \",(0,e.jsx)(n.a,{href:\"https://github.com/FormidableLabs/prism-react-renderer\",children:\"prism-react-renderer\"}),\" \\u8FD9\\u4E2A\\u5305\\u3002\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u6211\\u4EEC\\u7684\\u4EE3\\u7801\\u5757\\uFF0C\\u901A\\u8FC7\",(0,e.jsx)(n.code,{children:\"mdx-bundler\"}),\"\\u8F6C\\u6362\\u540E\\uFF0C\\u662F\\u653E\\u5728\",(0,e.jsx)(n.code,{children:\"<pre></pre>\"}),\"\\u6807\\u7B7E\\u4E2D\\u7684\\u3002\\u4E3A\\u4E86\\u6539\\u53D8\\u4EE3\\u7801\\u5757\\u7684\\u6837\\u5F0F\\uFF0C\\u6211\\u4EEC\\u53EF\\u4EE5\\u81EA\\u5B9A\\u4E49\\u8F6C\\u6362\\u540E\\u7684\",(0,e.jsx)(n.code,{children:\"<pre></pre>\"}),\"\\u6807\\u7B7E\\u3002\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u4E0A\\u9762\\u8BB2\\u8FC7\\uFF0C\\u6211\\u4EEC\\u8BFB\\u53D6\\u5230\\u7684 MDX \\u6587\\u4EF6\\u662F\\u901A\\u8FC7\",(0,e.jsx)(n.code,{children:\"bundleMDX()\"}),\"\\u8FD9\\u4E2A\\u65B9\\u6CD5\\u8FDB\\u884C\\u8F6C\\u6362\\u540E\\uFF0C\\u518D\\u901A\\u8FC7\",(0,e.jsx)(n.code,{children:\"getMDXComponent()\"}),\"\\u8FD9\\u4E2A\\u65B9\\u6CD5\\u8F6C\\u6210 React \\u7EC4\\u4EF6\\u7684\\u3002\\u8F6C\\u6362\\u751F\\u6210\\u7684\\u7EC4\\u4EF6\\uFF08\",(0,e.jsx)(n.code,{children:\"<Content/>\"}),\"\\uFF09\\u6709\\u4E00\\u4E2A\",(0,e.jsx)(n.code,{children:\"components\"}),\"\\u5C5E\\u6027\\uFF0C\\u53EF\\u4EE5\\u66FF\\u6362\\u751F\\u6210\\u7684 HTML \\u6807\\u7B7E\\u3002\"]}),`\n`,(0,e.jsx)(n.h3,{children:\"\\u7B2C\\u4E00\\u6B65\\uFF1A\\u521B\\u5EFA\\u4EE3\\u7801\\u5757\\u7EC4\\u4EF6\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u6211\\u4EEC\\u53EF\\u4EE5\\u521B\\u5EFA\\u4E00\\u4E2A\",(0,e.jsx)(n.code,{children:\"<CodeBlock/>\"}),\"\\u7EC4\\u4EF6\\uFF0C\\u7528\\u4E8E\\u66FF\\u6362\",(0,e.jsx)(n.code,{children:\"<pre></pre>\"}),\"\\u6807\\u7B7E\\u3002\\u5728\",(0,e.jsx)(n.code,{children:\"components/\"}),\"\\u76EE\\u5F55\\u4E0B\\uFF0C\\u6211\\u4EEC\\u65B0\\u5EFA\",(0,e.jsx)(n.code,{children:\"CodeBlock.jsx\"}),\"\\u6587\\u4EF6\\u3002\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-jsx\",metastring:\"title=components/CodeBlock.jsx\",children:`import Highlight, { defaultProps } from \"prism-react-renderer\";\n\nconst CodeBlock = ({ children }) => {\n  const { className, children: code } = children.props;\n  const language = className && className.replace(/language-/, \"\");\n  return (\n    <Highlight {...defaultProps} code={code} language={language}>\n      {({ className, style, tokens, getLineProps, getTokenProps }) => (\n        <div className=\"code-block-container\">\n          <pre className={className} style={style}>\n            <div className=\"code-block\">\n              {tokens.slice(0, -1).map((line, i) => (\n                <span key={i} {...getLineProps({ line, key: i })}>\n                  {line.map((token, key) => (\n                    <span key={key} {...getTokenProps({ token, key })} />\n                  ))}\n                </span>\n              ))}\n            </div>\n          </pre>\n        </div>\n      )}\n    </Highlight>\n  );\n};\n\nexport default CodeBlock;\n`})}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u9996\\u5148\",(0,e.jsx)(n.code,{children:\"<CodeBlock/>\"}),\"\\u7EC4\\u4EF6\\u63A5\\u53D7\\u4E00\\u4E2A\\u540D\\u53EB\",(0,e.jsx)(n.code,{children:\"children\"}),\"\\u7684 props\\uFF0C\\u5B83\\u7684\",(0,e.jsx)(n.code,{children:\"type\"}),\"\\u5C5E\\u6027\\u662F\",(0,e.jsx)(n.code,{children:\"'code'\"}),\"\\uFF0C\\u8868\\u793A\\u8FD9\\u662F\\u4E00\\u4E2A\\u4EE3\\u7801\\u5757\\u3002\\u9664\\u6B64\\u4EE5\\u5916\",(0,e.jsx)(n.code,{children:\"children\"}),\"\\u8FD8\\u6709\\u4E00\\u4E2A\",(0,e.jsx)(n.code,{children:\"props\"}),\"\\u5C5E\\u6027\\uFF0C\\u5305\\u542B\",(0,e.jsx)(n.code,{children:\"className\"}),\"\\u548C\\u53C8\\u4E00\\u4E2A\",(0,e.jsx)(n.code,{children:\"children\"}),\"\\u5C5E\\u6027\\u3002\\u7ED3\\u6784\\u5927\\u81F4\\u5982\\u4E0B\\uFF1A\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-js\",children:`{\n  children: {\n    type: 'code',\n    props: {\n      className: 'language-js',\n      children: 'console.log(\"hi\")'\n    }\n  }\n}\n`})}),`\n`,(0,e.jsx)(n.p,{children:\"\\u6211\\u4EEC\\u5728 Markdonw \\u4E2D\\u5199\\u4EE3\\u7801\\u5757\\u65F6\\uFF0C\\u53EF\\u4EE5\\u8868\\u660E\\u4EE3\\u7801\\u8BED\\u8A00\\uFF0C\\u5982\\uFF1A\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-md\",children:'```js\\nconsole.log(\"hello\");\\n```\\n'})}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u5176\\u4E2D\",(0,e.jsx)(n.code,{children:\"children.props.className\"}),\"\\u5C31\\u662F\\u6839\\u636E\",(0,e.jsx)(n.code,{children:\"```\"}),\"\\u540E\\u9762\\u6240\\u586B\\u5199\\u7684\\u8BED\\u8A00\\u751F\\u6210\\u7684\\u5B57\\u7B26\\u4E32\\uFF0C\\u683C\\u5F0F\\u4E3A\",(0,e.jsx)(n.code,{children:\"'language-*'\"}),\"\\uFF0C\\u901A\\u8FC7\\u7B80\\u5355\\u7684\\u6B63\\u5219\\u5339\\u914D\\u6211\\u4EEC\\u5C31\\u80FD\\u5F97\\u5230\\u4EE3\\u7801\\u5757\\u7684\\u8BED\\u8A00\\u3002\\u800C\",(0,e.jsx)(n.code,{children:\"children.props.children\"}),\"\\u5219\\u4E3A\\u4EE3\\u7801\\u6587\\u672C\\u3002\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"prism-react-renderer \\u63D0\\u4F9B\\u4E86\\u4E00\\u4E2A\",(0,e.jsx)(n.code,{children:\"<Highlight/>\"}),\"\\u7EC4\\u4EF6\\uFF0C\\u7528\\u4E8E\\u9AD8\\u4EAE\\u4EE3\\u7801\\uFF0C\\u7528\\u6CD5\\u6BD4\\u8F83\\u7B80\\u5355\\uFF0C\\u5C06\\u5BF9\\u5E94\\u7684 props \\u4F20\\u5165\\u5373\\u53EF\\uFF0C\\u4E0D\\u518D\\u8D58\\u8FF0\\u3002\"]}),`\n`,(0,e.jsx)(n.h3,{children:\"\\u7B2C\\u4E8C\\u6B65\\uFF1A\\u66FF\\u6362\\u6807\\u7B7E\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u63A5\\u4E0B\\u6765\\u6211\\u4EEC\\u8981\\u505A\\u7684\\u5C31\\u662F\\u56DE\\u5230\",(0,e.jsx)(n.code,{children:\"<Post/>\"}),\"\\u7EC4\\u4EF6\\u4E2D\\uFF0C\\u5C06\",(0,e.jsx)(n.code,{children:\"CodeBlock\"}),\"\\u7EC4\\u4EF6\\u4F20\\u5165\\u66FF\\u6362\\u5373\\u53EF\\uFF1A\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-js\",metastring:\"title=pages/post/[id].js\",children:`import CodeBlock from \"components/CodeBlock\";\n\n// \\u4E0A\\u7565\n\nexport default function Post({ meta, code }) {\n  const Content = getMDXComponent(code);\n  return (\n    <PostLayout meta={meta}>\n      <Content components={pre: CodeBlock} />\n    </PostLayout>\n  );\n}\n`})}),`\n`,(0,e.jsx)(n.h3,{children:\"\\u7B2C\\u4E09\\u6B65\\uFF1A\\u4FEE\\u6539\\u4E3B\\u9898\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u5230\\u6B64\\uFF0C\\u6211\\u4EEC\\u7684\\u4EE3\\u7801\\u5C31\\u5DF2\\u7ECF\\u201C\\u4EAE\\u201D\\u8D77\\u6765\\u4E86\\u3002\\u9ED8\\u8BA4\\u4F7F\\u7528\\u7684\\u662F \",(0,e.jsx)(n.a,{href:\"https://github.com/FormidableLabs/prism-react-renderer/blob/master/src/themes/duotoneDark.js\",children:\"duotoneDark\"}),\" \\u4E3B\\u9898\\uFF0C\\u786E\\u5B9E\\u4E0D\\u592A\\u597D\\u770B\\uFF0C\\u6CA1\\u5173\\u7CFB\\uFF0C\\u6211\\u4EEC\\u53EF\\u4EE5\\u901A\\u8FC7\\u4E0B\\u9762\\u7684\\u65B9\\u6CD5\\u8FDB\\u884C\\u4FEE\\u6539\\u3002\"]}),`\n`,(0,e.jsx)(n.h4,{children:\"\\u65B9\\u6CD5\\u4E00\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u6211\\u4EEC\\u53EF\\u4EE5\\u76F4\\u63A5\\u4F7F\\u7528 prism-react-renderer \\u63D0\\u4F9B\\u7684\\u4E3B\\u9898\\uFF0C\\u53EF\\u4EE5\\u5728\",(0,e.jsx)(n.code,{children:\"prism-react-renderer/themes/\"}),\"\\u76EE\\u5F55\\u4E0B\\u627E\\u5230\\u5B83\\u4EEC\\uFF0C\\u7136\\u540E\\u76F4\\u63A5\\u4FEE\\u6539\",(0,e.jsx)(n.code,{children:\"<Highlight/>\"}),\"\\u7EC4\\u4EF6\\u4F20\\u5165\",(0,e.jsx)(n.code,{children:\"theme\"}),\"\\u5373\\u53EF\\uFF1A\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-jsx\",children:`import dracula from \"prism-react-renderer/themes/dracula\";\n\n<Highlight theme={dracula} />;\n`})}),`\n`,(0,e.jsx)(n.h4,{children:\"\\u65B9\\u6CD5\\u4E8C\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u7531\\u4E8E prism-react-renderer \\u751F\\u6210\\u4EE3\\u7801\\u5757\\u7684\\u6807\\u7B7E\\u4E2D\\u90FD\\u6DFB\\u52A0\\u4E86\\u76F8\\u5E94\\u7684 class\\uFF0C\\u6211\\u4EEC\\u53EF\\u4EE5\\u76F4\\u63A5\\u4F7F\\u7528 Prism \\u7684\\u4E3B\\u9898\\u3002\\u4E3B\\u9898\\u5728\\u7F51\\u4E0A\\u641C\\u4E00\\u4E0B\\u5C31\\u80FD\\u627E\\u5230\\uFF0C\\u76F4\\u63A5\\u628A css \\u62FF\\u8FC7\\u6765\\u4F7F\\u7528\\u5373\\u53EF\\u3002\"})]})}}var b=y;return j(D);})();\n;return Component;"},"__N_SSG":true}